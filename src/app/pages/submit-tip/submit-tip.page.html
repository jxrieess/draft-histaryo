<!-- src/app/pages/submit-tip/submit-tip.page.html -->
<ion-header>
  <ion-toolbar color="success">
    <ion-buttons slot="start">
      <ion-back-button (click)="goBack()"></ion-back-button>
    </ion-buttons>
    <ion-title>Submit Tip</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content class="ion-padding">

  <!-- Header Info -->
  <ion-card class="header-card">
    <ion-card-content>
      <div class="landmark-info">
        <ion-icon name="location" color="primary"></ion-icon>
        <div>
          <h2>{{ landmarkName }}</h2>
          <p>Share your knowledge and help other visitors!</p>
        </div>
      </div>
    </ion-card-content>
  </ion-card>

  <!-- Form -->
  <div>
    
    <!-- Tip Type Selection -->
    <ion-card>
      <ion-card-header>
        <ion-card-title>What type of tip are you sharing?</ion-card-title>
      </ion-card-header>
      
      <ion-card-content>
        <ion-radio-group [(ngModel)]="tipForm.tipType" name="tipType">
          <div class="tip-type-options">
            <div 
              *ngFor="let type of tipTypes" 
              class="tip-type-option"
              [class.selected]="tipForm.tipType === type.value">
              
              <ion-radio 
                [value]="type.value" 
                slot="start"
                [color]="tipForm.tipType === type.value ? 'primary' : 'medium'">
              </ion-radio>
              
              <div class="type-content">
                <ion-icon [name]="getTipTypeIcon(type.value)" [color]="tipForm.tipType === type.value ? 'primary' : 'medium'"></ion-icon>
                <div class="type-text">
                  <h3>{{ type.label }}</h3>
                  <p>{{ type.description }}</p>
                </div>
              </div>
            </div>
          </div>
        </ion-radio-group>
      </ion-card-content>
    </ion-card>

    <!-- Title Input -->
    <ion-card>
      <ion-card-content>
        <ion-item lines="none">
          <ion-label position="stacked">Title *</ion-label>
          <ion-input
            [(ngModel)]="tipForm.title"
            name="title"
            placeholder="Give your tip a descriptive title"
            maxlength="100"
            required>
          </ion-input>
        </ion-item>
        <div class="character-count">
          {{ tipForm.title.length }}/100 characters
        </div>
      </ion-card-content>
    </ion-card>

    <!-- Content Input -->
    <ion-card>
      <ion-card-content>
        <ion-item lines="none">
          <ion-label position="stacked">Content *</ion-label>
          <ion-textarea
            [(ngModel)]="tipForm.content"
            name="content"
            placeholder="Share your tip, experience, or knowledge here..."
            rows="6"
            maxlength="500"
            required>
          </ion-textarea>
        </ion-item>
        <div class="character-count">
          {{ tipForm.content.length }}/500 characters
        </div>
      </ion-card-content>
    </ion-card>

    <!-- Image Upload (for photo tips) -->
    <ion-card *ngIf="tipForm.tipType === 'photo' || selectedImage">
      <ion-card-header>
        <ion-card-title>
          <ion-icon name="camera" color="primary"></ion-icon>
          Photo
          <span *ngIf="tipForm.tipType === 'photo'" class="required-indicator">*</span>
        </ion-card-title>
      </ion-card-header>
      
      <ion-card-content>
        <!-- Image Preview -->
        <div *ngIf="selectedImage" class="image-preview">
          <img [src]="selectedImage" alt="Selected image" />
          <ion-button 
            fill="clear" 
            color="danger" 
            (click)="removeImage()"
            class="remove-image-btn">
            <ion-icon name="close-circle" slot="icon-only"></ion-icon>
          </ion-button>
        </div>

        <!-- Image Selection Buttons -->
        <div class="image-actions">
          <ion-button 
            *ngIf="!selectedImage"
            expand="block" 
            fill="outline" 
            (click)="presentImageOptions()">
            <ion-icon name="camera" slot="start"></ion-icon>
            Add Photo
          </ion-button>
          
          <ion-button 
            *ngIf="selectedImage"
            expand="block" 
            fill="outline" 
            (click)="presentImageOptions()">
            <ion-icon name="refresh" slot="start"></ion-icon>
            Change Photo
          </ion-button>
        </div>

        <p class="image-note">
          <ion-icon name="information-circle" color="medium"></ion-icon>
          Please ensure your photo is appropriate and relates to the landmark.
        </p>
      </ion-card-content>
    </ion-card>

    <!-- Guidelines -->
    <ion-card class="guidelines-card">
      <ion-card-header>
        <ion-card-title>
          <ion-icon name="information-circle" color="primary"></ion-icon>
          Submission Guidelines
        </ion-card-title>
      </ion-card-header>
      
      <ion-card-content>
        <ion-list lines="none">
          <ion-item>
            <ion-icon name="checkmark-circle" color="success" slot="start"></ion-icon>
            <ion-label class="ion-text-wrap">
              Be respectful and helpful to other visitors
            </ion-label>
          </ion-item>
          
          <ion-item>
            <ion-icon name="checkmark-circle" color="success" slot="start"></ion-icon>
            <ion-label class="ion-text-wrap">
              Share accurate and useful information
            </ion-label>
          </ion-item>
          
          <ion-item>
            <ion-icon name="checkmark-circle" color="success" slot="start"></ion-icon>
            <ion-label class="ion-text-wrap">
              Avoid promotional content or spam
            </ion-label>
          </ion-item>
          
          <ion-item>
            <ion-icon name="checkmark-circle" color="success" slot="start"></ion-icon>
            <ion-label class="ion-text-wrap">
              All submissions are reviewed before publication
            </ion-label>
          </ion-item>
        </ion-list>
      </ion-card-content>
    </ion-card>

    <!-- Submit Button -->
    <ion-button 
      expand="block" 
      (click)="submitTip()"
      [disabled]="isSubmitting"
      color="success"
      size="large"
      class="submit-button">
      
      <ion-spinner *ngIf="isSubmitting" name="crescent" slot="start"></ion-spinner>
      <ion-icon *ngIf="!isSubmitting" name="paper-plane" slot="start"></ion-icon>
      
      {{ isSubmitting ? 'Submitting...' : 'Submit Tip' }}
    </ion-button>

    <!-- Cancel Button -->
    <ion-button 
      expand="block" 
      fill="clear" 
      color="medium"
      (click)="goBack()"
      [disabled]="isSubmitting">
      Cancel
    </ion-button>

  </div>

</ion-content>